<!-- TOPIC PAGE -->
<div class="topic-page">
    <!-- Back to Dashboard Link -->
    <a href="{{ url_for('dashboard') }}" class="back-to-dashboard">
        ‚Üê Back to Dashboard
    </a>

    <!-- Topic Header -->
    <div class="topic-header">
        <h1>{{ active_topic.name }}</h1>
        <p>{{ active_topic.description }}</p>
    </div>

    <!-- Action Buttons -->
    <div class="topic-actions">
        <a href="{{ url_for('note.create_note', topic_id=active_topic.id) }}" method="GET" class="btn-action">Add Note</a>
        <a href="#" onclick="addResource(); return false;" class="btn-action">Add Resource</a>
        <a href="#" onclick="addSubtopic(); return false;" class="btn-action">Add Subtopic</a>
    </div>

    <!-- Topic Content -->
    <div class="topic-content">
        <!-- Resources Section -->
        <div class="content-section">
            <h2 class="section-title">
                <span class="section-icon">üìö</span>
                Resources
            </h2>
            {% if active_topic.resources %}
                <div class="resources-grid">
                    {% for resource in active_topic.resources %}
                        <div class="resource-card">
                            <div class="resource-thumbnail {{ resource.type|lower }}">
                                {% if resource.type == 'PDF' %}
                                    üìÑ
                                {% elif resource.type == 'Image' %}
                                    üñºÔ∏è
                                {% elif resource.type == 'Video' %}
                                    üé•
                                {% elif resource.type == 'Link' %}
                                    üîó
                                {% else %}
                                    üìé
                                {% endif %}
                            </div>
                            <div class="resource-info">
                                <div class="resource-title">{{ resource.title or 'Untitled Resource' }}</div>
                                <div class="resource-type">{{ resource.type or 'File' }}</div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-state">
                    <div class="empty-state-icon">üìö</div>
                    <p>No resources added yet. Click "Add Resource" to include learning materials.</p>
                </div>
            {% endif %}
        </div>

        <!-- Notes Section -->
        <div class="content-section">
            <h2 class="section-title">
                <span class="section-icon">üìù</span>
                Notes
            </h2>
            {% if active_topic.notes %}
                    {% for note in active_topic.notes %}
                        <a href="{{ url_for('note.view_note', note_id=note.id) }}">{{ note.title }}.{{ note.created_at }}</a>
                        <!-- Create delete button -->
                        <form action="{{ url_for('note.delete_note', note_id=note.id) }}" method="POST" style="display: inline;">
                            <button type="submit" class="toolbar-btn" onclick="return confirm('Are you sure you want to delete this note?')">Delete</button>
                        </form>
                        </br>
                    {% endfor %}
            {% else %}
                <div class="empty-state">
                    <div class="empty-state-icon">üìù</div>
                    <p>No notes created yet. Click "Add Note" to start taking notes.</p>
                </div>
            {% endif %}
        </div>

        <!-- Subtopic Section -->
        <div class="content-section">
            <h2 class="section-title">
                <span class="section-icon">üóÇÔ∏è</span>
                Subtopic
            </h2>
            {% if active_topic.subtopic %}
                <div class="subtopic-grid">
                    {% for subtopic in active_topic.subtopic %}
                        <div class="subtopic-card">
                            <div class="subtopic-icon">
                                {{ subtopic.emoji or 'üìå' }}
                            </div>
                            <div class="subtopic-content">
                                <div class="subtopic-title">{{ subtopic.name }}</div>
                                <div class="subtopic-description">
                                    {{ subtopic.description or 'No description provided' }}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-state">
                    <div class="empty-state-icon">üóÇÔ∏è</div>
                    <p>No subtopic created yet. Click "Add Subtopic" to organize this topic further.</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>
<div class="modal-backdrop" id="modalBackdrop" style="display: none;" onclick="closeCreateTopicModal()"></div>
<div class="create-resource-modal" id="createResourceModal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeCreateResourceModal()">&times;</span>
        <h2>Create Resource</h2>
        <form id="createResourceForm" action="" method="POST">
            <label for="name">Resource Name:</label>
            <input type="text" id="name" name="name" required>
            <label for="description">Description:</label>
            <textarea id="description" name="description" required></textarea>
            <label for="file">Upload File:</label>
            <input type="file" id="file" name="file">
            <button type="submit">Create</button>
        </form>
    </div>
</div>
<script>
    function createNote() {
        // Logic to create a new note
        document.getElementById('modalBackdrop').style.display = 'block';
        console.log('Create Note button clicked');
    }

    function closeCreateResourceModal() {
        document.getElementById('modalBackdrop').style.display = 'none';
        document.getElementById('createResourceModal').style.display = 'none';
    }

    function addResource() {
        // Logic to add a new resource
        document.getElementById('modalBackdrop').style.display = 'block';
        document.getElementById('createResourceModal').style.display = 'block';
        console.log('Add Resource button clicked');
    }

    function addSubtopic() {
        // Logic to add a new subtopic
        document.getElementById('modalBackdrop').style.display = 'block';
        console.log('Add Subtopic button clicked');
    }

</script>